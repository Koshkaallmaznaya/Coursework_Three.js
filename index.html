<!DOCTYPE html>
<html>
  <head>
    <meta charset=UTF-8 />
    <link rel="stylesheet" type="text/css" href="styles.css" />
  </head>
  <body>
    <div class="text-box">
      <div class="heading"># Follow Us</div>
      <div class="button-wrapper">
          <div class="button">Learn More</div>
          <div class="button">Contacts</div>
      </div>
    </div>

    <script src="three.min.js"></script>
    <script>
    let scene, camera, renderer, stars, starGeo; //объявили переменные

    function init() { //основная функция

      scene = new THREE.Scene(); //создаем сцену

      camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 1, 1000); //создаем камеру
      camera.position.z = 1; //позиция камеры
      camera.rotation.x = Math.PI/2; //поворот камеры

      renderer = new THREE.WebGLRenderer(); //создаем рендер
      renderer.setSize(window.innerWidth, window.innerHeight); //масштабируем по окну
      
      let loader = new THREE.TextureLoader(); //объявили переменную фона
        const bgTexture = loader.load('2.png'); //показали, где лежит фон
        scene.background = bgTexture; //добавили фон
        
      document.body.appendChild(renderer.domElement); //добавляем еще один узел HTML с определенным элементом рендера

      starGeo = new THREE.Geometry(); //создаем геометрию (один большой объект)
      
      for (let i = 0; i < 6000; i++) { //для каждой вершины:
        star = new THREE.Vector3( //создаем массив
          Math.random() * 600 - 300, //задаем рандомное положение
          Math.random() * 600 - 300,
          Math.random() * 600 - 300
        );
        star.velocity = 0; //задаем скорость элемента
        star.acceleration = 0.005; //задаем ускорение элемента
        starGeo.vertices.push(star); //добавляем массив с вершинами в объект
      }

      let sprite = new THREE.TextureLoader().load('1.png'); //создаем текстуру
      let starMaterial = new THREE.PointsMaterial({ //создаем материал
        size: 2, //задаем размер
        map: sprite, //сопоставляем с загруженным изображением
        transparent: true //для прозрачности краев объекта
      });

      stars = new THREE.Points(starGeo,starMaterial); //сопоставляем материал и точки в пространстве
      scene.add(stars); //добавляем их в сцену

      window.addEventListener("resize", onWindowResize, false); //для правильной работы при сжатии окна

      animate(); //запуск функции анимации
    }
    
    function onWindowResize() { //функция подгона размера под окно
        camera.aspect = window.innerWidth / window.innerHeight; //установка соотношения сторон
        camera.updateProjectionMatrix(); //обновляет камеру, применяя новые изменения
        renderer.setSize(window.innerWidth, window.innerHeight); //масштабируем по окну
    }
    
    function animate() { //функция анимации (каждый кадр)
      starGeo.vertices.forEach(p => { //просматриваем каждую вершину
        p.velocity += p.acceleration //обновляем скорость
        p.y -= p.velocity; //перемещаем элементы по оси у с заданной ранее скоростью
        
        if (p.y < -200) { //проверка дошла ли снежинка до экрана
          p.y = 200; //устанавливаем новое местоположение
          p.velocity = 0; //устанавливаем новую скорость
        }
      });
      starGeo.verticesNeedUpdate = true; //обновляем вершины 
      stars.rotation.y +=0.01; //поворот всех вершин
    
      renderer.render(scene, camera); //рекурсивно вызываем рендер
      requestAnimationFrame(animate); //указывает браузеру, что вы хотите произвести анимацию, и просит его запланировать перерисовку на следующем кадре анимации. Параметр - функция, которую вызовут перед перерисовкой
    }
    
    init(); //запуск основной функции
    
    </script>
  </body>
</html>
